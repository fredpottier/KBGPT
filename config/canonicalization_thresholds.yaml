# Configuration Seuils Adaptatifs pour Canonicalisation
# OSMOSE Phase 1.5 - Canonicalisation Robuste
# Date: 2025-10-16
#
# Les seuils sont ajustés selon le contexte documentaire:
# - domain: sap_ecosystem, cloud_computing, ai, enterprise_software, etc.
# - source: official_documentation, internal_documentation, forum_community, etc.
# - language: french, english, multilingual, technical_jargon
# - entity_type: PRODUCT, CONCEPT, ORGANIZATION, PERSON, TECHNOLOGY

profiles:
  # ========================================================================
  # Haute Confiance: Documentation Officielle SAP
  # ========================================================================
  SAP_OFFICIAL_DOCS:
    name: "SAP_OFFICIAL_DOCS"

    # Seuils de matching
    fuzzy_match_threshold: 0.90
    exact_match_required: false

    # Seuils auto-validation (P0.1 Sandbox)
    auto_validation_threshold: 0.95      # >= 0.95 → auto-validated
    require_human_validation_below: 0.85 # < 0.85 → requires admin

    # Seuils promotion (Gatekeeper)
    promotion_threshold: 0.75

    description: "Documentation SAP officielle (haute qualité, nomenclature standardisée)"

    applies_to:
      domain: "sap_ecosystem"
      source: "official_documentation"
      language: ["english", "french"]
      entity_types: ["PRODUCT", "SOLUTION", "COMPONENT"]


  # ========================================================================
  # Confiance Moyenne: Documentation Interne Entreprise
  # ========================================================================
  INTERNAL_DOCS:
    name: "INTERNAL_DOCS"

    fuzzy_match_threshold: 0.85
    exact_match_required: false

    auto_validation_threshold: 0.95
    require_human_validation_below: 0.75  # Plus tolérant que SAP officiel

    promotion_threshold: 0.70

    description: "Documentation interne entreprise (qualité variable, acronymes locaux possibles)"

    applies_to:
      source: "internal_documentation"
      language: ["french", "english", "multilingual"]


  # ========================================================================
  # Confiance Basse: Contenu Communautaire
  # ========================================================================
  COMMUNITY_CONTENT:
    name: "COMMUNITY_CONTENT"

    fuzzy_match_threshold: 0.80
    exact_match_required: false

    auto_validation_threshold: 0.97  # Plus strict car qualité variable
    require_human_validation_below: 0.70

    promotion_threshold: 0.65

    description: "Contenu communautaire (forums, slides, emails) - qualité très variable"

    applies_to:
      source:
        - "forum_community"
        - "presentation_slides"
        - "emails_chat"
      language: ["english", "french", "multilingual"]


  # ========================================================================
  # Très Haute Confiance: Produits SAP Catalogués
  # ========================================================================
  SAP_PRODUCTS_CATALOG:
    name: "SAP_PRODUCTS_CATALOG"

    fuzzy_match_threshold: 0.92
    exact_match_required: false

    auto_validation_threshold: 0.98  # Très strict
    require_human_validation_below: 0.90

    promotion_threshold: 0.80

    description: "Produits SAP catalogués (S/4HANA, SuccessFactors, etc.) - très haute confiance requise"

    applies_to:
      domain: "sap_ecosystem"
      entity_types: ["PRODUCT", "SOLUTION"]
      # Exemples: SAP S/4HANA Cloud, SAP SuccessFactors, SAP Ariba


  # ========================================================================
  # Confiance Ajustée: Multilangue ou Jargon Technique
  # ========================================================================
  MULTILINGUAL_TECHNICAL:
    name: "MULTILINGUAL_TECHNICAL"

    fuzzy_match_threshold: 0.82  # Plus tolérant
    exact_match_required: false

    auto_validation_threshold: 0.95
    require_human_validation_below: 0.75

    promotion_threshold: 0.68

    description: "Documents multilingues ou jargon technique dense (plus de tolérance)"

    applies_to:
      language:
        - "multilingual"
        - "technical_jargon"
      entity_types: ["TECHNOLOGY", "CONCEPT", "ACRONYM"]


  # ========================================================================
  # Cloud Computing (Générique)
  # ========================================================================
  CLOUD_PROVIDERS:
    name: "CLOUD_PROVIDERS"

    fuzzy_match_threshold: 0.88
    exact_match_required: false

    auto_validation_threshold: 0.95
    require_human_validation_below: 0.82

    promotion_threshold: 0.73

    description: "Providers cloud (AWS, Azure, GCP, etc.) - nomenclature standardisée"

    applies_to:
      domain: "cloud_computing"
      entity_types: ["PRODUCT", "PLATFORM", "SERVICE"]


  # ========================================================================
  # Intelligence Artificielle & Machine Learning
  # ========================================================================
  AI_ML_DOMAIN:
    name: "AI_ML_DOMAIN"

    fuzzy_match_threshold: 0.85
    exact_match_required: false

    auto_validation_threshold: 0.93
    require_human_validation_below: 0.78

    promotion_threshold: 0.70

    description: "Domaine IA/ML (modèles, frameworks, techniques) - terminologie évolutive"

    applies_to:
      domain: "artificial_intelligence"
      entity_types: ["TECHNOLOGY", "MODEL", "FRAMEWORK", "ALGORITHM"]


  # ========================================================================
  # Profil Par Défaut (Fallback)
  # ========================================================================
  DEFAULT:
    name: "DEFAULT"

    fuzzy_match_threshold: 0.85
    exact_match_required: false

    auto_validation_threshold: 0.95
    require_human_validation_below: 0.80

    promotion_threshold: 0.70

    description: "Profil par défaut (balanced) - utilisé si aucun contexte spécifique"

    applies_to: {}


# ============================================================================
# Règles de Sélection (Priorité)
# ============================================================================
# L'ordre de priorité pour sélectionner un profil est:
# 1. Domaine SAP + Type PRODUCT → SAP_PRODUCTS_CATALOG
# 2. Domaine SAP + Source officielle → SAP_OFFICIAL_DOCS
# 3. Source communautaire → COMMUNITY_CONTENT
# 4. Domaine Cloud Computing → CLOUD_PROVIDERS
# 5. Domaine IA/ML → AI_ML_DOMAIN
# 6. Multilingue/jargon → MULTILINGUAL_TECHNICAL
# 7. Docs internes → INTERNAL_DOCS
# 8. Fallback → DEFAULT

selection_rules:
  priority:
    - condition:
        domain: "sap_ecosystem"
        entity_type: "PRODUCT"
      profile: "SAP_PRODUCTS_CATALOG"

    - condition:
        domain: "sap_ecosystem"
        source: "official_documentation"
      profile: "SAP_OFFICIAL_DOCS"

    - condition:
        source: ["forum_community", "presentation_slides", "emails_chat"]
      profile: "COMMUNITY_CONTENT"

    - condition:
        domain: "cloud_computing"
      profile: "CLOUD_PROVIDERS"

    - condition:
        domain: "artificial_intelligence"
      profile: "AI_ML_DOMAIN"

    - condition:
        language: ["multilingual", "technical_jargon"]
      profile: "MULTILINGUAL_TECHNICAL"

    - condition:
        source: "internal_documentation"
      profile: "INTERNAL_DOCS"

    - condition: {}  # Fallback: toujours vrai
      profile: "DEFAULT"


# ============================================================================
# Configuration Globale
# ============================================================================
global:
  # Activer/désactiver seuils adaptatifs
  enabled: true

  # Fichier de log pour décisions seuils
  log_decisions: true
  log_file: "data/logs/threshold_decisions.log"

  # Rechargement automatique du fichier (sans restart)
  auto_reload: true
  reload_interval_seconds: 300  # 5 minutes

  # Mode debug
  debug_mode: false  # Si true, log toutes les sélections de profils


# ============================================================================
# Contextes Valides (Référence)
# ============================================================================
# Cette section est documentaire pour aider les admins à configurer

valid_contexts:
  domains:
    - sap_ecosystem
    - cloud_computing
    - artificial_intelligence
    - enterprise_software
    - cybersecurity
    - general

  sources:
    - official_documentation
    - internal_documentation
    - forum_community
    - presentation_slides
    - emails_chat
    - unknown

  languages:
    - french
    - english
    - multilingual
    - technical_jargon

  entity_types:
    - PRODUCT
    - CONCEPT
    - ORGANIZATION
    - PERSON
    - TECHNOLOGY
    - SOLUTION
    - COMPONENT
    - ACRONYM
    - PLATFORM
    - SERVICE
    - MODEL
    - FRAMEWORK
    - ALGORITHM
    - UNKNOWN
