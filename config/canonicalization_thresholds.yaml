# =============================================================================
# Configuration Seuils Adaptatifs pour Canonicalisation
# OSMOSE - Version Domain-Agnostic
# Date: 2025-12-18
# =============================================================================
#
# Les seuils sont ajustés selon le contexte documentaire:
# - source: official_documentation, internal_documentation, forum_community, etc.
# - language: french, english, multilingual, technical_jargon
# - entity_type: PRODUCT, CONCEPT, ORGANIZATION, PERSON, TECHNOLOGY
#
# Note: Le domaine métier est appris dynamiquement via le Domain Context
# configuré par le client. Ces profils sont génériques.
#
# =============================================================================

profiles:
  # ========================================================================
  # Haute Confiance: Documentation Officielle
  # ========================================================================
  OFFICIAL_DOCS:
    name: "OFFICIAL_DOCS"

    # Seuils de matching
    fuzzy_match_threshold: 0.90
    exact_match_required: false

    # Seuils auto-validation
    auto_validation_threshold: 0.95      # >= 0.95 → auto-validated
    require_human_validation_below: 0.85 # < 0.85 → requires admin

    # Seuils promotion (Gatekeeper)
    promotion_threshold: 0.75

    description: "Documentation officielle (haute qualité, nomenclature standardisée)"

    applies_to:
      source: "official_documentation"
      language: ["english", "french"]
      entity_types: ["PRODUCT", "SOLUTION", "COMPONENT"]


  # ========================================================================
  # Confiance Moyenne: Documentation Interne Entreprise
  # ========================================================================
  INTERNAL_DOCS:
    name: "INTERNAL_DOCS"

    fuzzy_match_threshold: 0.85
    exact_match_required: false

    auto_validation_threshold: 0.95
    require_human_validation_below: 0.75

    promotion_threshold: 0.70

    description: "Documentation interne entreprise (qualité variable, acronymes locaux possibles)"

    applies_to:
      source: "internal_documentation"
      language: ["french", "english", "multilingual"]


  # ========================================================================
  # Confiance Basse: Contenu Communautaire
  # ========================================================================
  COMMUNITY_CONTENT:
    name: "COMMUNITY_CONTENT"

    fuzzy_match_threshold: 0.80
    exact_match_required: false

    auto_validation_threshold: 0.97  # Plus strict car qualité variable
    require_human_validation_below: 0.70

    promotion_threshold: 0.65

    description: "Contenu communautaire (forums, slides, emails) - qualité très variable"

    applies_to:
      source:
        - "forum_community"
        - "presentation_slides"
        - "emails_chat"
      language: ["english", "french", "multilingual"]


  # ========================================================================
  # Très Haute Confiance: Produits Catalogués
  # ========================================================================
  PRODUCTS_CATALOG:
    name: "PRODUCTS_CATALOG"

    fuzzy_match_threshold: 0.92
    exact_match_required: false

    auto_validation_threshold: 0.98  # Très strict
    require_human_validation_below: 0.90

    promotion_threshold: 0.80

    description: "Produits catalogués dans l'ontologie - très haute confiance requise"

    applies_to:
      entity_types: ["PRODUCT", "SOLUTION"]


  # ========================================================================
  # Confiance Ajustée: Multilangue ou Jargon Technique
  # ========================================================================
  MULTILINGUAL_TECHNICAL:
    name: "MULTILINGUAL_TECHNICAL"

    fuzzy_match_threshold: 0.82  # Plus tolérant
    exact_match_required: false

    auto_validation_threshold: 0.95
    require_human_validation_below: 0.75

    promotion_threshold: 0.68

    description: "Documents multilingues ou jargon technique dense (plus de tolérance)"

    applies_to:
      language:
        - "multilingual"
        - "technical_jargon"
      entity_types: ["TECHNOLOGY", "CONCEPT", "ACRONYM"]


  # ========================================================================
  # Profil Par Défaut (Fallback)
  # ========================================================================
  DEFAULT:
    name: "DEFAULT"

    fuzzy_match_threshold: 0.85
    exact_match_required: false

    auto_validation_threshold: 0.95
    require_human_validation_below: 0.80

    promotion_threshold: 0.70

    description: "Profil par défaut (balanced) - utilisé si aucun contexte spécifique"

    applies_to: {}


# ============================================================================
# Règles de Sélection (Priorité)
# ============================================================================
# L'ordre de priorité pour sélectionner un profil est:
# 1. Type PRODUCT/SOLUTION → PRODUCTS_CATALOG
# 2. Source officielle → OFFICIAL_DOCS
# 3. Source communautaire → COMMUNITY_CONTENT
# 4. Multilingue/jargon → MULTILINGUAL_TECHNICAL
# 5. Docs internes → INTERNAL_DOCS
# 6. Fallback → DEFAULT

selection_rules:
  priority:
    - condition:
        entity_type: ["PRODUCT", "SOLUTION"]
      profile: "PRODUCTS_CATALOG"

    - condition:
        source: "official_documentation"
      profile: "OFFICIAL_DOCS"

    - condition:
        source: ["forum_community", "presentation_slides", "emails_chat"]
      profile: "COMMUNITY_CONTENT"

    - condition:
        language: ["multilingual", "technical_jargon"]
      profile: "MULTILINGUAL_TECHNICAL"

    - condition:
        source: "internal_documentation"
      profile: "INTERNAL_DOCS"

    - condition: {}  # Fallback: toujours vrai
      profile: "DEFAULT"


# ============================================================================
# Configuration Globale
# ============================================================================
global:
  # Activer/désactiver seuils adaptatifs
  enabled: true

  # Fichier de log pour décisions seuils
  log_decisions: true
  log_file: "data/logs/threshold_decisions.log"

  # Rechargement automatique du fichier (sans restart)
  auto_reload: true
  reload_interval_seconds: 300  # 5 minutes

  # Mode debug
  debug_mode: false  # Si true, log toutes les sélections de profils


# ============================================================================
# Contextes Valides (Référence)
# ============================================================================
# Cette section est documentaire pour aider les admins à configurer

valid_contexts:
  sources:
    - official_documentation
    - internal_documentation
    - forum_community
    - presentation_slides
    - emails_chat
    - unknown

  languages:
    - french
    - english
    - multilingual
    - technical_jargon

  entity_types:
    - PRODUCT
    - CONCEPT
    - ORGANIZATION
    - PERSON
    - TECHNOLOGY
    - SOLUTION
    - COMPONENT
    - ACRONYM
    - PLATFORM
    - SERVICE
    - MODEL
    - FRAMEWORK
    - ALGORITHM
    - UNKNOWN
