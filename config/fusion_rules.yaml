# üåä OSMOSE Semantic Intelligence - Fusion Rules Configuration
# Phase 1.8.1d: Configuration SmartConceptMerger

# Configuration globale
fusion:
  enabled: true

  # Types de documents √©ligibles pour extraction locale
  # (autres types utilisent TopicSegmenter classique)
  local_extraction_types:
    - PPTX
    - PPTX_SLIDES

  # Strat√©gie fallback si aucune r√®gle appliqu√©e
  # Options: "preserve_all" | "merge_similar"
  fallback_strategy: preserve_all

  # Taille min cluster pour fusion (√©viter fusions uniques)
  min_cluster_size: 2

  # R√®gles de fusion (ordre = priorit√© d'application)
  rules:
    # ============================================
    # R√®gle 1: Main Entities Merge
    # ============================================
    - name: main_entities_merge
      enabled: true
      priority: 1  # Haute priorit√©
      config:
        # Ratio d'occurrence minimum (0.5% des slides)
        # Exemple: Concept r√©p√©t√© 2 fois sur 230 slides = 0.87% ‚Üí fusionn√© si similaire
        # Ajust√© pour documents longs (230 slides) o√π r√©p√©tition 2-3√ó = d√©j√† significatif
        min_occurrence_ratio: 0.005

        # Seuil de similarit√© pour fusionner concepts
        # Cosine similarity ‚â• 0.88 ‚Üí fusionner
        similarity_threshold: 0.88

        # Types de concepts √©ligibles pour fusion (domain-agnostic, lowercase)
        # Les types sont d√©couverts dynamiquement par le LLM selon le contexte m√©tier
        eligible_types:
          - entity       # Entit√©s g√©n√©rales (produits, plateformes, syst√®mes, etc.)
          - product      # Produits sp√©cifiques (si LLM le d√©tecte)
          - technology   # Technologies (si LLM le d√©tecte)

    # ============================================
    # R√®gle 2: Alternatives & Features
    # ============================================
    - name: alternatives_features
      enabled: true
      priority: 2  # Moyenne priorit√©
      config:
        # Mots-cl√©s indicateurs d'alternatives/comparaisons
        antonym_keywords:
          - "vs"
          - "versus"
          - "instead of"
          - "alternative"
          - "compared to"
          - "or"

        # Co-occurrence minimale requise (slides communs)
        # Exemple: Multi-Tenancy et Single-Tenant mentionn√©s ensemble sur ‚â•3 slides
        min_co_occurrence: 3

    # ============================================
    # R√®gle 3: Slide-Specific Preservation
    # ============================================
    - name: slide_specific_preserve
      enabled: true
      priority: 3  # Basse priorit√© (apr√®s fusions)
      config:
        # Occurrence maximale pour consid√©rer "rare"
        # Concepts mentionn√©s ‚â§ 2 fois ‚Üí pr√©serv√©s
        max_occurrence: 2

        # Types de concepts √† pr√©server (d√©tails techniques, domain-agnostic, lowercase)
        # Les types sont d√©couverts dynamiquement par le LLM selon le contexte m√©tier
        preserve_types:
          - metric       # M√©triques (Response Time < 200ms)
          - detail       # D√©tails sp√©cifiques
          - technical    # Informations techniques
          - value        # Valeurs num√©riques

        # Longueur minimale du nom (d√©tails pr√©cis ont noms longs)
        # Exemple: "Response Time < 200ms (P95)" = 28 chars ‚Üí pr√©serv√©
        min_name_length: 10

# ============================================
# Configuration avanc√©e (Phase 2)
# ============================================
advanced:
  # Activer logging d√©taill√©
  verbose_logging: false

  # Activer m√©triques performance
  performance_tracking: true

  # Cache embeddings (√©conomiser appels API)
  cache_embeddings: true
  cache_ttl_seconds: 3600  # 1 heure
