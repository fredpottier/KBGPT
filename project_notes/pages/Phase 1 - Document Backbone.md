- #phase #documents #p0 #blocking
- phase-number:: 1
- status:: [[PENDING]]
- priority:: P0 - BLOQUANT PROMESSE
- duration:: 5 semaines
- effort:: 200 heures
- dependencies:: [[Phase 0 - Security Hardening]]
- blocking-for:: [[Phase 2 - Facts Governance Finalization]]
-
- ## üéØ Objectif
	- √âtablir la colonne vert√©brale documentaire du syst√®me
	- Tra√ßabilit√© compl√®te de l'origine des faits
	- Versioning et anti-duplicate robuste
-
- ## üìã T√¢ches Principales
	- ### 1. Mod√®le Neo4j Document/DocumentVersion
		- TODO Cr√©er nodes `(:Document)` avec uuid, filename, tenant_id
		- TODO Cr√©er nodes `(:DocumentVersion)` avec version, checksum, ingested_at
		- TODO Relations `(:Document)-[:HAS_VERSION]->(:DocumentVersion)`
		- TODO Migration des imports existants vers nouveau mod√®le
		- estimated-effort:: 50h
	-
	- ### 2. Anti-Duplicate par Checksum
		- TODO Calculer SHA-256 checksum lors upload
		- TODO V√©rifier existence avant ingestion
		- TODO Endpoint `/documents/check-duplicate`
		- TODO UI feedback si duplicate d√©tect√©
		- estimated-effort:: 30h
	-
	- ### 3. Versioning Automatique
		- TODO D√©tecter re-upload m√™me filename
		- TODO Auto-incr√©menter version (v1, v2, v3...)
		- TODO Endpoint `/documents/{uuid}/versions`
		- TODO UI historique des versions
		- estimated-effort:: 40h
	-
	- ### 4. Lineage Facts ‚Üí Document
		- TODO Ajouter `source_document_uuid` sur tous les Facts
		- TODO Relation `(:Fact)-[:EXTRACTED_FROM]->(:DocumentVersion)`
		- TODO Query Cypher pour tracer origine d'un fait
		- TODO UI affichage source sur chaque fact
		- estimated-effort:: 50h
	-
	- ### 5. API Documents
		- TODO POST `/documents/upload` avec checksum
		- TODO GET `/documents` liste pagin√©e
		- TODO GET `/documents/{uuid}` d√©tails + versions
		- TODO DELETE `/documents/{uuid}` (cascade facts)
		- estimated-effort:: 30h
-
- ## ‚úÖ Crit√®res d'Acceptance
	- [ ] Upload document = cr√©ation Document + DocumentVersion en Neo4j
	- [ ] Re-upload m√™me fichier = refus√© (duplicate)
	- [ ] Re-upload m√™me nom mais contenu diff√©rent = nouvelle version
	- [ ] Chaque Fact pointe vers DocumentVersion source
	- [ ] Query "D'o√π vient ce fait ?" retourne document + page
	- [ ] Suppression Document = cascade sur Facts
	- [ ] Tests e2e upload ‚Üí versioning ‚Üí lineage
-
- ## üìä M√©triques de Succ√®s
	- **Tra√ßabilit√©** : 100% des facts ont source_document_uuid
	- **Anti-duplicate** : 0 doublons dans 1000 imports test
	- **Performance** : Checksum + verification < 200ms
-
- ## üîó R√©f√©rences
	- [[BACK2PROMISE_MASTER_ROADMAP]] Section "Phase 1"
	- [[Back2Promise Project]]
-
- ## üìù Notes de Session
	-
